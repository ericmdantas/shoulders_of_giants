/* js minificado Sat Dec 06 2014 21:33:29 GMT-0200 (Horário brasileiro de verão) */ "use strict";var quotesApp=angular.module("quotes",["ngResource","emd.client.storage.module","emd.client.socket.module"]);quotesApp.constant("author",{name:"Eric Mendes Dantas",github:"https://github.com/ericmdantas"}),quotesApp.controller("QuotesController",["$scope","QuotesModel","QuotesDAO","SocketService","Randomizer",function(a,b,c,d,e){a.quotes=[],a.quotesKeeper=[],a.favQuote=c.favQuote,d.on("quote:faved",function(b){for(var c=0;c<a.quotes.length;c++)if(b===a.quotes[c]._id){a.quotes[c].likes+=1;break}}),a.setOrder=function(b){if(lib.isStringInvalid(b))throw new Error("Ordenação incorreta. O tipo do parâmetro deve ser uma string.");a.getOrder=b};var f=function(){var b=function(b){a.quotes=b,a.quotesKeeper=angular.copy(a.quotes),a.$broadcast("quotes-ready")};c.getAll().then(b)};a.setSingle=function(b){if(lib.isObjectInvalid(b))throw new Error("Houve um erro ao randomizar as mensagens. O objeto passado não é um objeto ou array válido.");var c=b.length,d=Math.floor(Math.random()*c),d=Math.floor(Math.random()*c);a.quotes=[b[d]],a.singleView=!0},a.setMultiple=function(){a.singleView=!1,a.quotes=a.quotesKeeper},a.randomize=function(){a.quotes=e.shuffleSingle(a.quotesKeeper)},a.setOrder("author"),f()}]),quotesApp.directive("activable",[function(){return function(a,b,c){b.on("click",function(){var a=c.deactive;if(lib.isStringInvalid(a))throw new Error("É necessário informar o caminho do element a ser removido a classe active.");$(a).removeClass("active"),b.addClass("active")})}}]),quotesApp.directive("emdOptionsNavigation",[function(){var a="partials/includes/options-navigation.html",b=["$scope","Randomizer",function(a,b){a.modalOptions={titulo:null,conteudo:[]},a.onViewClick=function(){a.modalOptions={titulo:"View",conteudo:[{nome:"Single",onClick:function(){a.setSingle(a.quotes)}},{nome:"Multiple",onClick:a.setMultiple}]}},a.onOrderByClick=function(){a.modalOptions={titulo:"Order By",conteudo:[{nome:"Quote",onClick:function(){a.getOrder="quotes"}},{nome:"Author",onClick:function(){a.getOrder="author"}},{nome:"Most liked",onClick:function(){a.getOrder="-likes"}}]}},a.onShuffleClick=function(){a.getOrder=null,b.shuffle(a.quotes)}}],c=function(a){a.$watch("modalOptions",function(){2===a.modalOptions.conteudo.length&&$(".modal-body button").addClass("col-sm-6 col-md-6 col-lg-6"),3===a.modalOptions.conteudo.length&&$(".modal-body button").addClass("col-sm-4 col-md-4 col-lg-4")})};return{restrict:"E",templateUrl:a,controller:b,link:c}}]),quotesApp.directive("showModalWhenNoQuotes",[function(){var a="partials/includes/modal-loading.html",b=function(a){var b="#modal-loading-quotes";$(b).modal("show");var c=a.$on("quotes-ready",function(){$(b).modal("hide"),c()})},c={};return{restrict:"E",templateUrl:a,link:b,scope:c}}]),quotesApp.directive("like",["ClientStorageService",function(){var a="partials/includes/likes.html",b=function(a,b){a.star="fa-star-o",b.on("click",function(){a.star="fa-star"})};return{restrict:"E",templateUrl:a,link:b,scope:{liked:"&",numberlikes:"@"}}}]),quotesApp.directive("toTheTop",["$window",function(a){var b='<div id="to-the-top" class="transition"><strong>top</strong></div>',c=function(b,c){c.fadeOut("fast"),c.on("click",function(){a.scrollTo(0,0)}),$(a).on("scroll",function(){a.scrollY<100?c.fadeOut("slow"):c.fadeIn("slow")})};return{restrict:"E",template:b,link:c}}]);var lib={};!function(a){var b=function(a){return!a||"string"!=typeof a||!a.length||!a.trim().length},c=function(a){return!a||"object"!=typeof a||!Object.keys(a).length},d=function(a){return!a||"function"!=typeof a};a.isStringInvalid=b,a.isObjectInvalid=c,a.isFunctionInvalid=d}("undefined"==typeof exports?lib:exports),quotesApp.factory("QuotesModel",[function(){function a(a){angular.extend(this,a)}return a.prototype={author:null,quote:null,likes:0},a}]),quotesApp.factory("QuotesResource",["$resource",function(a){var b="/api/quotes/:type/:id",c={id:"@id"},d={update:{method:"PUT"}};return a(b,c,d)}]),quotesApp.service("QuotesDAO",["$q","SocketService","QuotesModel","QuotesResource",function(a,b,c,d){var e=function(){var b=a.defer(),e=function(a){var d=[];angular.forEach(a,function(a){d.push(new c(a))}),b.resolve(d)};return d.query().$promise.then(e),b.promise},f=function(a){if(!angular.isString(a))throw new Error("O id passado não é uma string válida. Não será possível favoritar a mensagem.");b.emit("fav:quote",a)};this.getAll=e,this.favQuote=f}]),quotesApp.service("Randomizer",[function(){var a=function(a){for(var b,c,d=a.length;d;)c=Math.floor(Math.random()*d--),b=a[d],a[d]=a[c],a[c]=b;return a},b=function(a){var b=a.length,c=Math.floor(Math.random()*b);return[a[c]]};this.shuffle=a,this.shuffleSingle=b}]);